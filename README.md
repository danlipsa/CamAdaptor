This project provides a ParaView Catalyst adaptor for CAM5 simulation.

To build CAM5 and the adapter:

1. Download CESM (Community Earth System Model) using instructions in:

    <http://www.cesm.ucar.edu/models/cesm1.2/cesm/doc/usersguide/book1.html>

    and cam\_catalyst\_adapter from:
    
    Store cam_catalyst_adapter in ~/cesm\_1\_2\_1/models/atm/cam directory.

2. Modify configure-cam.sh, gen-cam.sh, build-namelist.sh such that
   CAM\_ROOT points to the location for cesm1_2_1 sources.
   The scripts assume that cesm1\_2\_1 is stored in ~/src/cesm\_1\_2\_1
   Apply cesm_1_2_1.patch to the cesm code.

3. Create a CAM5 build directory, cd into it and configure it:

        mkdir ~/build/cam-5.3
        cd ~/build/cam-5.3
        ~/src/cesm1_2_1/models/atm/cam/cam_catalyst_adapter/configure-cam.sh

    Note you have to configure the number of MPI processors and use the same
    number when you run the simulation.

4. Try building CAM5. This step creates mod files used by the adapter.

        ~/src/cesm1_2_1/models/atm/cam/cam_catalyst_adapter/build-cam.sh
   You'll get errors as the adapter is not built yet.

5. Create adapter's build directory and configure it. Make sure you
specify ParaView's build (or installation) directory. Build the
adapter:

        mkdir ~/build/cam-5.3/cam_catalyst_adapter
        cd ~/build/cam-5.3/cam_catalyst_adapter
        ccmake ~/src/cesm1_2_1/models/atm/cam/cam_catalyst_adapter
        make

6. Build CAM5:

        cd ..
        ~/src/cesm1_2_1/models/atm/cam/cam_catalyst_adapter/build-cam.sh

7. Create a run directory for the simulation, create the namelist
   (parameters for the simulation) and run the simulation.

        mkdir ~/run/cam-5.3
        cd ~/run/cam-5.3
        ~/src/cesm1_2_1/models/atm/cam/cam_catalyst_adapter/build-namelist.sh | grep FOUND
   Namelists (parameters) for the simulation are listed in:

   <http://www.cesm.ucar.edu/cgi-bin/eaton/namelist/nldef2html-cam5_3>

    Different configurations need different data files. If any of the required
    data files are NOT FOUND download them from:
    <https://svn-ccsm-inputdata.cgd.ucar.edu/trunk/inputdata>
    Don't checkout everything as the datafiles are big!
    First checkout individual empty directories leading to the file you
    are interested in:
    
        cd cesm-data
        svn update --depth empty atm
        cd atm
        svn update --depth empty cam
        cd cam
        svn update --depth empty inic
        cd inic
        svn update --depth empty homme
        cd homme
        
    Then checkout the file:

        svn update cami-mam3_0000-01-01_ne30np4_L30_c130424.nc


    Run the simulation:

        ~/src/cesm1_2_1/models/atm/cam/cam_catalyst_adapter/run-cam.sh
        
    The data fields generated by the simulation (those stored in the
    .nc file) are listed in:
   
   <http://www.cesm.ucar.edu/models/cesm1.2/cam/docs/ug5_3/hist_flds_fv_cam5.html>

8. Optional: If you want to debug certain pio files in the simulation run:

        ~/src/cesm1_2_1/models/atm/cam/cam_catalyst_adapter/gen-cam.sh d

    This command copies a list of .F90.in to the corresponding .F90
    so that gdb works correctly over these files. When you need to rebuild
    run:
    
        ~/src/cesm1_2_1/models/atm/cam/cam_catalyst_adapter/gen-cam.sh g


